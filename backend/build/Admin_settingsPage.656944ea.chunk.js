(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[5895],{58659:(O,R,t)=>{"use strict";t.r(R),t.d(R,{SettingsPage:()=>xt,default:()=>Kt});var e=t(67294),f=t(95489),s=t(49656),r=t(28702),c=t(97132),S=t(15482),K=t(48474),Z=t(38683),$=t(15861),X=t(64687),y=t.n(X),Ce=t(23724),re=t(41363),Ae=t(87751),le=t(45697),E=t.n(le);const G=750,Ee=100,me=["image/jpeg","image/png","image/svg+xml"];var ae=t(18172);const je={localImage:void 0},x=(C=je,m)=>(0,ae.default)(C,g=>{switch(m.type){case"SET_LOCAL_IMAGE":{g.localImage=m.value;break}default:return g}}),ce=({onChangeLogo:C,customLogo:m,goTo:g,Component:A,modalTitle:u,next:te,prev:N,currentStep:H})=>{const[{localImage:k},w]=(0,e.useReducer)(x,je),{formatMessage:be}=(0,c.useIntl)(),oe=Pe=>{w({type:"SET_LOCAL_IMAGE",value:Pe})},ke=()=>{g(null)};return H?e.createElement(r.ModalLayout,{labelledBy:"modal",onClose:ke},e.createElement(r.ModalHeader,null,e.createElement(r.Typography,{fontWeight:"bold",as:"h2",id:"modal"},be(u))),e.createElement(A,{setLocalImage:oe,goTo:g,next:te,prev:N,onClose:ke,asset:k||m,onChangeLogo:C})):null};ce.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},ce.propTypes={Component:E().elementType,currentStep:E().string,customLogo:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}),goTo:E().func.isRequired,modalTitle:E().shape({id:E().string,defaultMessage:E().string}),next:E().string,onChangeLogo:E().func.isRequired,prev:E().string};const Y=ce,j={currentStep:void 0},_=(C=j,m)=>(0,ae.default)(C,g=>{switch(m.type){case"GO_TO":{g.currentStep=m.to;break}default:return g}});var Oe=t(27821);const D={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},U={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},q=C=>new Promise(m=>{const g=new FileReader;g.onload=()=>{const A=new Image;A.onload=function(){m({width:A.width,height:A.height})},A.src=g.result},g.readAsDataURL(C)}),ee=(C,m)=>({ext:C.name.split(".").pop(),size:C.size/1e3,name:C.name,url:URL.createObjectURL(C),rawFile:C,width:m.width,height:m.height}),ye=async C=>{let m;if(!me.includes(C.type))throw m=new Error("File format"),m.displayMessage=D,m;const A=await q(C);if(!(A.width<=G&&A.height<=G))throw m=new Error("File sizing"),m.displayMessage=U,m;const te=ee(C,A);if(!(te.size<=Ee))throw m=new Error("File sizing"),m.displayMessage=U,m;return te},v=(0,Oe.default)(r.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,ge=({setLocalImage:C,goTo:m,next:g,onClose:A})=>{const{formatMessage:u}=(0,c.useIntl)(),[te,N]=(0,e.useState)(!1),[H,k]=(0,e.useState)(void 0),w=(0,e.useRef)(null),be=()=>N(!0),oe=()=>N(!1),ke=Ze=>{Ze.preventDefault(),w.current.click()},Pe=async()=>{oe();const Ze=w.current.files[0];if(Ze)try{const ze=await ye(Ze);C(ze),m(g)}catch(ze){if(ze.displayMessage)k(u(ze.displayMessage,{size:Ee,dimension:G})),w.current.focus();else throw ze}},We=()=>te?"primary500":H?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(r.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(r.Field,{name:"logo-upload",error:H},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(r.Stack,{spacing:2},e.createElement(r.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:te?"primary100":"neutral100",borderColor:We(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:be,onDragLeave:oe},e.createElement(r.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:re.PicturePlus,"aria-hidden":!0}),e.createElement(r.Box,{paddingTop:3,paddingBottom:5},e.createElement(r.Typography,{variant:"delta",as:"span"},u({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(v,{accept:me,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Pe,ref:w,id:"logo-upload"}),e.createElement(r.Button,{type:"button",onClick:ke},u({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(r.Box,{paddingTop:6},e.createElement(r.Typography,{variant:"pi",textColor:"neutral600"},u({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:Ee,dimension:G})))),e.createElement(r.FieldError,null)))))),e.createElement(r.ModalFooter,{startActions:e.createElement(r.Button,{onClick:A,variant:"tertiary"},u({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};ge.defaultProps={next:null},ge.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const Fe=ge;var Be=t(11817);const Re=async C=>{try{const m=await Be.Z.get(C,{responseType:"blob",timeout:8e3});return new File([m.data],m.config.url,{type:m.headers["content-type"]})}catch(m){throw m.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},m}},V=({goTo:C,next:m,onClose:g,setLocalImage:A})=>{const{formatMessage:u}=(0,c.useIntl)(),[te,N]=(0,e.useState)(""),[H,k]=(0,e.useState)(null),w=oe=>{N(oe.target.value)},be=async()=>{try{const oe=await Re(te),ke=await ye(oe);A(ke),C(m)}catch(oe){if(oe.displayMessage)k(u(oe.displayMessage,{size:Ee,dimension:G}));else throw oe}};return e.createElement("form",{onSubmit:oe=>{oe.preventDefault(),be()}},e.createElement(r.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(r.TextInput,{label:u({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:H,onChange:w,value:te,name:"logo-url"})),e.createElement(r.ModalFooter,{startActions:e.createElement(r.Button,{onClick:g,variant:"tertiary"},u({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(r.Button,{type:"submit"},u({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};V.defaultProps={next:null},V.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const ie=V,Ue=({setLocalImage:C,goTo:m,next:g,onClose:A})=>{const{formatMessage:u}=(0,c.useIntl)();return e.createElement(r.TabGroup,{label:u({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(r.Box,{paddingLeft:8,paddingRight:8},e.createElement(r.Tabs,null,e.createElement(r.Tab,null,u({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(r.Tab,null,u({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(r.Divider,null)),e.createElement(r.TabPanels,null,e.createElement(r.TabPanel,null,e.createElement(Fe,{onClose:A,setLocalImage:C,goTo:m,next:g})),e.createElement(r.TabPanel,null,e.createElement(ie,{onClose:A,setLocalImage:C,goTo:m,next:g}))))};Ue.defaultProps={next:null},Ue.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const $e=Ue,lt=({asset:C})=>{const{formatMessage:m}=(0,c.useIntl)();return e.createElement(r.Card,null,e.createElement(r.CardHeader,null,e.createElement(r.CardAsset,{size:"S",src:C.url})),e.createElement(r.CardBody,null,e.createElement(r.CardContent,null,e.createElement(r.CardTitle,null,C.name),e.createElement(r.CardSubtitle,null,`${C.ext.toUpperCase()} - ${C.width}\u2715${C.height}`)),e.createElement(r.CardBadge,null,m({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};lt.propTypes={asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired};const J=lt,ve=({onClose:C,asset:m,prev:g,next:A,goTo:u,setLocalImage:te,onChangeLogo:N})=>{const{formatMessage:H}=(0,c.useIntl)(),k=()=>{te(void 0),u(g)},w=()=>{N(m),u(A)};return e.createElement(e.Fragment,null,e.createElement(r.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(r.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(r.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(r.Typography,{variant:"pi",fontWeight:"bold"},H({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(r.Typography,{variant:"pi",textColor:"neutral500"},H({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(r.Button,{onClick:k,variant:"secondary"},H({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(r.Box,{maxWidth:(0,f.pxToRem)(180)},e.createElement(J,{asset:m}))),e.createElement(r.ModalFooter,{startActions:e.createElement(r.Button,{onClick:C,variant:"tertiary"},H({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(r.Button,{onClick:w},H({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};ve.defaultProps={next:null,prev:null},ve.propTypes={goTo:E().func.isRequired,asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired,next:E().string,onClose:E().func.isRequired,onChangeLogo:E().func.isRequired,prev:E().string,setLocalImage:E().func.isRequired};const yt={upload:{Component:$e,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:ve,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},at=({canUpdate:C,customLogo:m,defaultLogo:g,hint:A,label:u,onChangeLogo:te,onResetLogo:N})=>{const[{currentStep:H},k]=(0,e.useReducer)(_,j),{Component:w,next:be,prev:oe,modalTitle:ke}=yt[H]||{},{formatMessage:Pe}=(0,c.useIntl)(),We=Ze=>{k({type:"GO_TO",to:Ze})};return e.createElement(e.Fragment,null,e.createElement(r.CarouselInput,{label:u,selectedSlide:0,hint:A,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:m?.name||"logo.png",actions:e.createElement(r.CarouselActions,null,e.createElement(r.IconButton,{disabled:!C,onClick:()=>We(m?"pending":"upload"),label:Pe({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(re.Plus,null)}),m&&e.createElement(r.IconButton,{disabled:!C,onClick:N,label:Pe({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(re.Refresh,null)}))},e.createElement(r.CarouselSlide,{label:Pe({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(r.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:m?.url||g,alt:Pe({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(Y,{Component:w,currentStep:H,onChangeLogo:te,customLogo:m,goTo:We,next:be,prev:oe,modalTitle:ke}))};at.defaultProps={canUpdate:!1,customLogo:null,hint:null},at.propTypes={canUpdate:E().bool,customLogo:E().shape({url:E().string,name:E().string}),label:E().string.isRequired,hint:E().string,defaultLogo:E().string.isRequired,onChangeLogo:E().func.isRequired,onResetLogo:E().func.isRequired};const Ve=at,vt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},sn=(C=vt,m)=>(0,ae.default)(C,g=>{switch(m.type){case"SET_CUSTOM_MENU_LOGO":{g.menuLogo.display=m.value,g.menuLogo.submit.rawFile=m.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{g.authLogo.display=m.value,g.authLogo.submit.rawFile=m.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{g.menuLogo.display=null,g.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{g.authLogo.display=null,g.authLogo.submit={rawFile:null,isReset:!0};break}default:return g}});var He=t(82492),rn=t.n(He);const cn=(C,m)=>rn()(C,{menuLogo:{display:m.menuLogo},authLogo:{display:m.authLogo}}),Ke=(0,e.forwardRef)(({canUpdate:C,projectSettingsStored:m},g)=>{const{formatMessage:A}=(0,c.useIntl)(),{trackUsage:u}=(0,f.useTracking)(),{logos:{menu:te,auth:N}}=(0,K.um)(),[{menuLogo:H,authLogo:k},w]=(0,e.useReducer)(sn,vt,()=>cn(vt,m)),be=We=>{w({type:"SET_CUSTOM_MENU_LOGO",value:We})},oe=()=>{u("didClickResetLogo",{logo:"menu"}),w({type:"RESET_CUSTOM_MENU_LOGO"})},ke=We=>{w({type:"SET_CUSTOM_AUTH_LOGO",value:We})},Pe=()=>{u("didClickResetLogo",{logo:"auth"}),w({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(g,()=>({getValues:()=>({menuLogo:H.submit,authLogo:k.submit})})),e.createElement(r.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(r.Typography,{variant:"delta",as:"h3"},A({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(r.Typography,{variant:"pi",textColor:"neutral600"},A({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:G,size:Ee})),e.createElement(r.Grid,{paddingTop:4,gap:4},e.createElement(r.GridItem,{col:6,s:12},e.createElement(Ve,{canUpdate:C,customLogo:H.display,defaultLogo:te.default,hint:A({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:A({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:be,onResetLogo:oe})),e.createElement(r.GridItem,{col:6,s:12},e.createElement(Ve,{canUpdate:C,customLogo:k.display,defaultLogo:N.default,hint:A({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:A({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:ke,onResetLogo:Pe}))))});Ke.defaultProps={canUpdate:!1,projectSettingsStored:null},Ke.propTypes={canUpdate:E().bool,projectSettingsStored:E().shape({menuLogo:E().shape({url:E().string,name:E().string})})};const dn=Ke;var _e=t(68718),St=t.n(_e);const dt=C=>St()(C,(m,g,A)=>{g&&g.url?m[A]={...g,url:(0,f.prefixFileUrlWithBackendUrl)(g.url)}:m[A]=g},{}),Ot=async()=>{const{get:C}=(0,f.getFetchClient)(),{data:m}=await C("/admin/project-settings");return dt(m)},Tt=async C=>{const{post:m}=(0,f.getFetchClient)(),{data:g}=await m("/admin/project-settings",C,{headers:{"Content-Type":"multipart/form-data"}});return dt(g)},At=C=>{const m=new FormData;return Object.entries(C).forEach(([g,A])=>{A&&A.rawFile instanceof File&&m.append(g,A.rawFile),A&&A.isReset&&m.append(g,null)}),m};var Bt=function(){return window&&window.strapi&&window.strapi.isEE?t(78413).Z:t(69767).Z}(),Rt=function(){var m=(0,e.useRef)(),g=(0,f.useNotification)(),A=(0,f.useTracking)(),u=A.trackUsage,te=(0,c.useIntl)(),N=te.formatMessage,H=(0,Ce.useQueryClient)();(0,f.useFocusWhenNavigate)();var k=(0,f.useAppInfos)(),w=k.latestStrapiReleaseTag,be=k.shouldUpdateStrapi,oe=k.strapiVersion,ke=(0,K.um)(),Pe=ke.updateProjectSettings,We=(0,f.useRBAC)(Ae.Z.settings["project-settings"]),Ze=We.allowedActions,ze=Ze.canRead,pt=Ze.canUpdate,gt=ze&&pt,Xt=(0,Ce.useQuery)("project-settings",Ot,{enabled:ze}),Qt=Xt.data,Yt=(0,Ce.useMutation)(function(ht){return Tt(ht)},{onSuccess:function(ft){return(0,$.Z)(y().mark(function tt(){var Qe,Ye;return y().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return Qe=ft.menuLogo,Ye=ft.authLogo,Je.next=3,H.invalidateQueries("project-settings",{refetchActive:!0});case 3:Pe({menuLogo:Qe?.url,authLogo:Ye?.url});case 4:case"end":return Je.stop()}},tt)}))()}}),Jt=function(ft){if(ft.preventDefault(),!!pt){var tt=m.current.getValues(),Qe=At(tt);Yt.mutate(Qe,{onSuccess:function(){var st=tt.menuLogo,Je=tt.authLogo;st.rawFile&&u("didChangeLogo",{logo:"menu"}),Je.rawFile&&u("didChangeLogo",{logo:"auth"}),g({type:"success",message:N({id:"app",defaultMessage:"Saved"})})},onError:function(){g({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})}};return e.createElement(r.Layout,null,e.createElement(f.SettingsPageTitle,{name:"Application"}),e.createElement(r.Main,null,e.createElement("form",{onSubmit:Jt},e.createElement(r.HeaderLayout,{title:N({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:N({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:gt&&e.createElement(r.Button,{type:"submit",startIcon:e.createElement(re.Check,null)},N({id:"global.save",defaultMessage:"Save"}))}),e.createElement(r.ContentLayout,null,e.createElement(r.Stack,{spacing:6},e.createElement(r.Stack,{spacing:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(r.Typography,{variant:"delta",as:"h3"},N({id:"global.details",defaultMessage:"Details"})),e.createElement(r.Grid,{gap:5,as:"dl"},e.createElement(r.GridItem,{col:6,s:12},e.createElement(r.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},N({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(r.Flex,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(r.Typography,null,"v",oe),be&&e.createElement(r.Link,{href:"https://github.com/strapi/strapi/releases/tag/".concat(w),isExternal:!0,endIcon:e.createElement(re.ExternalLink,null)},N({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"})))),e.createElement(r.GridItem,{col:6,s:12},e.createElement(r.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},N({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(r.Flex,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(r.Typography,null,N({id:"Settings.application.ee-or-ce",defaultMessage:"{communityEdition, select, true {Community Edition} other {Enterprise Edition}}"},{communityEdition:k.communityEdition})),e.createElement(r.Link,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(re.ExternalLink,null)},N({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(r.GridItem,{col:6,s:12},e.createElement(r.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},N({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(r.Typography,{as:"dd"},k.nodeVersion)),e.createElement(Bt,null))),ze&&Qt&&e.createElement(dn,{canUpdate:pt,ref:m,projectSettingsStored:Qt}))))))};const kt=Rt;var un=t(94654),wt=t.n(un);const jt=C=>wt()(C,g=>g.links).map(g=>(0,Z.ot)(g.Component,g.to,g.exact||!1)),$t=C=>C.filter(m=>!m.links.every(g=>g.isDisplayed===!1));var et=t(42982),Mt=function(){return window&&window.strapi&&window.strapi.isEE?t(26789).Z:t(73871).Z}(),mn=function(){return window&&window.strapi&&window.strapi.isEE?t(64527).Z:t(85302).Z}(),Lt=[{Component:function(){return{default:mn}},to:"/settings/roles",exact:!0},{Component:function(){return{default:Mt}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:Mt}},to:"/settings/roles/new",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(2544).then(t.bind(t,92100));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/roles/:id",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5199).then(t.bind(t,37735));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/users",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4263).then(t.bind(t,22282));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/users/:id",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,3672));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/webhooks/create",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,9311));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4121).then(t.bind(t,6784));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/webhooks",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(8056).then(t.bind(t,87427));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/api-tokens",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(4583),t.e(4299)]).then(t.bind(t,9683));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(4583),t.e(92)]).then(t.bind(t,28465));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/api-tokens/:id",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(3219),t.e(4816)]).then(t.bind(t,39987));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/transfer-tokens/create",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(9600).then(t.bind(t,70798));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/transfer-tokens",exact:!0},{Component:function(){return(0,$.Z)(y().mark(function m(){var g;return y().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(3219),t.e(2492)]).then(t.bind(t,9452));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/transfer-tokens/:id",exact:!0}];const pn=Lt;var Wt=function(){return window&&window.strapi&&window.strapi.isEE?t(5420).Z:t(35301).Z}();const zt=[].concat((0,et.Z)(Wt),(0,et.Z)(pn));var Zt=t(92978),Gt=t(18386),ut=t(34446),Vt=t(29489),Dt=t(52305);const mt=({menu:C})=>{const{formatMessage:m}=(0,c.useIntl)(),{trackUsage:g}=(0,f.useTracking)(),{pathname:A}=(0,s.useLocation)(),te=$t(C).map(k=>({...k,title:k.intlLabel,links:k.links.map(w=>({...w,title:w.intlLabel,name:w.id}))})),N=m({id:"global.settings",defaultMessage:"Settings"}),H=(k=null)=>{g("willNavigate",{from:A,to:k})};return e.createElement(Zt.m,{ariaLabel:N},e.createElement(Gt.p,{label:N}),e.createElement(ut.Z,null,te.map(k=>e.createElement(Vt.D,{key:k.id,label:m(k.intlLabel)},k.links.map(w=>e.createElement(Dt.E,{as:s.NavLink,withBullet:w.hasNotification,to:w.to,onClick:()=>H(w.to),key:w.id},m(w.intlLabel)))))))};mt.propTypes={menu:E().array.isRequired};const Ht=mt;function xt(){const{settingId:C}=(0,s.useParams)(),{settings:m}=(0,f.useStrapiApp)(),{formatMessage:g}=(0,c.useIntl)(),{isLoading:A,menu:u}=(0,K.Te)(),te=(0,e.useMemo)(()=>(0,Z.WW)(zt.map(({to:k,Component:w,exact:be})=>(0,Z.ot)(w,k,be))),[]),N=jt(m);if(A)return e.createElement(f.LoadingIndicatorPage,null);if(!C)return e.createElement(s.Redirect,{to:"/settings/application-infos"});const H=g({id:"global.settings",defaultMessage:"Settings"});return e.createElement(r.Layout,{sideNav:e.createElement(Ht,{menu:u})},e.createElement(S.Helmet,{title:H}),e.createElement(s.Switch,null,e.createElement(s.Route,{path:"/settings/application-infos",component:kt,exact:!0}),te,N))}const Kt=(0,e.memo)(xt)},69767:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=()=>null},73871:(O,R,t)=>{"use strict";t.d(R,{Z:()=>r});var e=t(67294),f=t(49656);const r=()=>e.createElement(f.Redirect,{to:"/404"})},79578:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},56195:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},35820:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},53558:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},99047:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},28834:(O,R,t)=>{"use strict";t.d(R,{Z:()=>to});var e=t(67294),f=t(45697),s=t.n(f),r=t(95489),c=t(28702),S=t(18721),K=t.n(S),Z=t(41609),$=t.n(Z),X=t(97132),y=t(27821),Ce=t(89734),re=t.n(Ce),Ae=t(70885),le=t(41363),E=t(27361),G=t.n(E),Ee=t(57557),me=t.n(Ee),ae=t(48474);const je=y.default.div`
  position: relative;

  ${({hasConditions:o,disabled:n,theme:a})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${n?a.colors.neutral100:a.colors.primary600};
    }
  `}
`,Ge=({onClick:o,className:n,hasConditions:a,variant:i})=>{const{formatMessage:l}=(0,X.useIntl)();return e.createElement(je,{hasConditions:a,className:n},e.createElement(c.Button,{variant:i,startIcon:e.createElement(le.Cog,null),onClick:o},l({id:"global.settings",defaultMessage:"Settings"})))};Ge.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},Ge.propTypes={onClick:s().func.isRequired,className:s().string,hasConditions:s().bool,variant:s().string};const x=(0,y.default)(Ge)``;var ce=t(18172),Y=t(7739),j=t.n(Y),xe=t(11700),_=t.n(xe);const Oe=o=>Object.values(o).map(n=>Object.entries(n).filter(([,a])=>a).map(([a])=>a)).flat(),D=o=>o.reduce((n,[a,i])=>(n.push({label:_()(a),children:i.map(l=>({label:l.displayName,value:l.id}))}),n),[]),U=(o,n)=>o.map(([,a])=>a).flat().reduce((a,i)=>({[i.id]:n.includes(i.id),...a}),{});var q=function(){return window&&window.strapi&&window.strapi.isEE?t(53273).Z:t(79578).Z}(),ee=function(n){var a=n.arrayOfOptionsGroupedByCategory,i=n.isFormDisabled,l=n.isGrey,d=n.label,p=n.name,h=n.onChange,b=n.value,T=(0,X.useIntl)(),M=T.formatMessage,L=function(W){h(p,U(a,W))};return e.createElement(c.Flex,{as:"li",background:l?"neutral100":"neutral0",paddingBottom:3,paddingTop:3},e.createElement(c.Flex,{paddingLeft:6,style:{width:180}},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},M({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(c.Typography,{variant:"sigma",title:d,textColor:"primary600",ellipsis:!0},M({id:"Settings.roles.form.permissions.".concat(d.toLowerCase()),defaultMessage:d})),e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",M({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(c.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(c.MultiSelectNested,{id:p,customizeContent:function(W){return"".concat(W.length," currently selected")},onChange:L,value:Oe(b),options:D(a),disabled:i||q})))};ee.propTypes={arrayOfOptionsGroupedByCategory:s().array.isRequired,isFormDisabled:s().bool.isRequired,isGrey:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,value:s().object.isRequired,onChange:s().func.isRequired};const ye=ee;var v=t(96486);const ge=(o,n)=>o.reduce((a,i)=>(a[i.id]=(0,v.get)(n,i.id,!1),a),{}),Fe=(o,n)=>o.reduce((a,i)=>{const[l,d]=i,p=ge(d,n);return a[l]=p,a},{}),se=(o,n,a)=>o.reduce((i,l)=>{const d=(0,v.get)(n,[...l.pathToConditionsObject,"conditions"],{}),p=Fe(a,d);return i[l.pathToConditionsObject.join("..")]=p,i},{}),Re=({actions:o,headerBreadCrumbs:n,isFormDisabled:a,onClosed:i,onToggle:l})=>{const{formatMessage:d}=(0,X.useIntl)(),{availableConditions:p,modifiedData:h,onChangeConditions:b}=(0,ae.$_)(),T=(0,e.useMemo)(()=>Object.entries(j()(p,"category")),[p]),M=o.filter(({isDisplayed:P,hasSomeActionsSelected:B,hasAllActionsSelected:Q})=>P&&(B||Q)),L=(0,e.useMemo)(()=>se(M,h,T),[M,h,T]),[I,W]=(0,e.useState)(L),F=(P,B)=>{W((0,ce.default)(Q=>{Q[P]||(Q[P]={}),Q[P].default||(Q[P].default={}),Q[P].default=B}))},z=()=>{const P=Object.entries(I).reduce((B,Q)=>{const[de,Ne]=Q,Se=Object.values(Ne).reduce((he,Me)=>({...he,...Me}),{});return B[de]=Se,B},{});b(P),l()};return e.createElement(c.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:i},e.createElement(c.ModalHeader,null,e.createElement(c.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:n.join(", ")},n.map(P=>e.createElement(c.Crumb,{key:P},_()(d({id:P,defaultMessage:P})))))),e.createElement(c.ModalBody,null,M.length===0&&e.createElement(c.Typography,null,d({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,M.map(({actionId:P,label:B,pathToConditionsObject:Q},de)=>{const Ne=Q.join("..");return e.createElement(ye,{key:P,arrayOfOptionsGroupedByCategory:T,label:B,isFormDisabled:a,isGrey:de%2===0,name:Ne,onChange:F,value:G()(I,Ne,{})})}))),e.createElement(c.ModalFooter,{startActions:e.createElement(c.Button,{variant:"tertiary",onClick:l},d({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(c.Button,{onClick:z},d({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};Re.propTypes={actions:s().arrayOf(s().shape({actionId:s().string.isRequired,checkboxName:s().string,hasSomeActionsSelected:s().bool.isRequired,hasAllActionsSelected:s().bool,isDisplayed:s().bool.isRequired,label:s().string})).isRequired,headerBreadCrumbs:s().arrayOf(s().string).isRequired,isFormDisabled:s().bool.isRequired,onClosed:s().func.isRequired,onToggle:s().func.isRequired};const V=Re,ie=`${120/16}rem`,Ue=`${200/16}rem`,$e=`${53/16}rem`,J=y.default.div`
  width: ${ie};
`,ct=(0,y.default)(c.Flex)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`,Et=({children:o,isCollapsable:n,isActive:a,isFormDisabled:i,label:l,onChange:d,onClick:p,checkboxName:h,someChecked:b,value:T})=>{const{formatMessage:M}=(0,X.useIntl)();return e.createElement(c.Flex,{alignItems:"center",paddingLeft:6,style:{width:Ue,flexShrink:0}},e.createElement(c.Box,{paddingRight:2},e.createElement(c.BaseCheckbox,{name:h,"aria-label":M({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l}),disabled:i,onValueChange:L=>d({target:{name:h,value:L}}),indeterminate:b,value:T})),e.createElement(ct,{title:l,alignItems:"center",isCollapsable:n,...n&&{onClick:p,"aria-expanded":a,onKeyDown:({key:L})=>(L==="Enter"||L===" ")&&p(),tabIndex:0,role:"button"}},e.createElement(c.Typography,{fontWeight:a?"bold":"",textColor:a?"primary600":"neutral800",ellipsis:!0},_()(l)),o))};Et.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},Et.propTypes={checkboxName:s().string,children:s().node,label:s().string.isRequired,isCollapsable:s().bool,isFormDisabled:s().bool.isRequired,onChange:s().func,onClick:s().func.isRequired,someChecked:s().bool,value:s().bool,isActive:s().bool.isRequired};const yt=(0,e.memo)(Et),at=o=>(0,v.isObject)(o)?(0,v.flattenDeep)(Object.values(o).map(n=>(0,v.isObject)(n)?at(n):n)):[],Ve=at,bt=o=>o?Object.keys(o).reduce((n,a)=>(a!=="conditions"&&(n[a]=o[a]),n),{}):null,He=o=>{const n=bt(o),a=Ve(n);if(!a.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const i=a.every(d=>d),l=a.some(d=>d)&&!i;return{hasAllActionsSelected:i,hasSomeActionsSelected:l}},ln=(o,n,a)=>o.map(({actionId:i,isDisplayed:l,applyToProperties:d,label:p})=>{if(!l)return{actionId:i,hasSomeActionsSelected:!1,isDisplayed:l};const h=[...a.split(".."),i],b=(0,v.isEmpty)(d)?[...h,"properties","enabled"]:h,T=b.join(".."),M=(0,v.get)(n,[...h,"conditions"],null),L=Ve(M).some(z=>z);if((0,v.isEmpty)(d)){const z=(0,v.get)(n,b,!1);return{actionId:i,checkboxName:T,hasAllActionsSelected:z,hasConditions:L,hasSomeActionsSelected:z,isDisplayed:l,isParentCheckbox:!1,label:p,pathToConditionsObject:h}}const I=(0,v.get)(n,b,null),{hasAllActionsSelected:W,hasSomeActionsSelected:F}=He(I);return{actionId:i,checkboxName:T,hasAllActionsSelected:W,hasConditions:L,hasSomeActionsSelected:F,isDisplayed:l,isParentCheckbox:!0,label:p,pathToConditionsObject:h}}),Ke=(0,y.default)(le.CarretDown)`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,_e=o=>`
  ${c.Typography} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${Ke} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var St=function(){return window&&window.strapi&&window.strapi.isEE?t(20591).Z:t(56195).Z}(),It=function o(n,a){return`
  `.concat(dt,` {
    background-color: `).concat(n.colors.primary100,`;
    color: `).concat(n.colors.primary600,`;
    border-radius: `).concat(a?"2px 2px 0 0":"2px",`;
  }
  `).concat(Ft,` {
    display: flex;
  }
  `).concat(x,` {
    display: block;
  }
  &:hover {
   `).concat(_e(n),`
  }

  &:focus-within {
    `).concat(function(i){var l=i.theme,d=i.isActive;return o(l,d)},`
  }
  
`)},dt=y.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],$e,function(o){var n=o.isGrey,a=o.theme;return n?a.colors.neutral100:a.colors.neutral0}),Ot=y.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],x,function(o){var n=o.isActive,a=o.theme;return n&&It(a,n)},function(o){var n=o.theme,a=o.isActive;return It(n,a)}),Tt=(0,y.default)(c.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],ie),Ft=(0,y.default)(c.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var n=o.theme;return n.colors.primary600}),At=y.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var n=o.theme;return n.colors.primary600}),Bt=(0,y.default)(c.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),Rt=function(n){var a=n.availableActions,i=n.isActive,l=n.isGrey,d=n.isFormDisabled,p=n.label,h=n.onClickToggle,b=n.pathToData,T=(0,e.useState)(!1),M=(0,Ae.Z)(T,2),L=M[0],I=M[1],W=(0,X.useIntl)(),F=W.formatMessage,z=(0,ae.$_)(),P=z.modifiedData,B=z.onChangeParentCheckbox,Q=z.onChangeSimpleCheckbox,de=function(){I(function(pe){return!pe})},Ne=function(){I(!1)},Se=G()(P,b.split(".."),{}),he=(0,e.useMemo)(function(){return Object.keys(Se).reduce(function(ne,pe){return ne[pe]=me()(Se[pe],"conditions"),ne},{})},[Se]),Me=He(he),Te=Me.hasAllActionsSelected,nt=Me.hasSomeActionsSelected,ue=(0,e.useMemo)(function(){return ln(a,P,b)},[a,P,b]),Le=ue.some(function(ne){var pe=ne.hasConditions;return pe});return e.createElement(Ot,{isActive:i},e.createElement(dt,{isGrey:l},e.createElement(yt,{isCollapsable:!0,isFormDisabled:d,label:p,checkboxName:b,onChange:B,onClick:h,someChecked:nt,value:Te,isActive:i},e.createElement(Ft,{paddingLeft:2},i?e.createElement(le.ChevronUp,null):e.createElement(le.ChevronDown,null))),e.createElement(c.Flex,{style:{flex:1}},ue.map(function(ne){var pe=ne.actionId,fe=ne.hasConditions,De=ne.hasAllActionsSelected,Ie=ne.hasSomeActionsSelected,qe=ne.isDisplayed,we=ne.isParentCheckbox,Xe=ne.checkboxName,it=ne.label;return qe?we?e.createElement(Tt,{key:pe,justifyContent:"center",alignItems:"center"},fe&&e.createElement(At,null),e.createElement(c.BaseCheckbox,{disabled:d||St,name:Xe,"aria-label":F({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(it," ").concat(p)}),onValueChange:function(ot){B({target:{name:Xe,value:ot}})},indeterminate:Ie,value:De})):e.createElement(Tt,{key:pe,justifyContent:"center",alignItems:"center"},fe&&e.createElement(At,null),e.createElement(c.BaseCheckbox,{disabled:d||St,indeterminate:fe,name:Xe,onValueChange:function(ot){Q({target:{name:Xe,value:ot}})},value:De})):e.createElement(J,{key:pe})})),L&&e.createElement(V,{headerBreadCrumbs:[p,"Settings.permissions.conditions.conditions"],actions:ue,isFormDisabled:d,onClosed:Ne,onToggle:de})),e.createElement(Bt,null,e.createElement(x,{onClick:de,hasConditions:Le})))};Rt.propTypes={availableActions:s().array.isRequired,isActive:s().bool.isRequired,isGrey:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggle:s().func.isRequired,pathToData:s().string.isRequired};const kt=Rt,wt=(o,n)=>o.map(a=>{const i=Array.isArray(a.applyToProperties)&&a.applyToProperties.indexOf(n)!==-1&&a.isDisplayed;return{label:a.label,actionId:a.actionId,isActionRelatedToCurrentProperty:i}}),Nt=(0,y.default)(c.Flex)`
  width: ${ie};
  flex-shrink: 0;
`,jt=(0,y.default)(c.Flex)`
  width: ${Ue};
  height: ${$e};
  flex-shrink: 0;
`,Ut=({headers:o,label:n})=>{const{formatMessage:a}=(0,X.useIntl)(),i=a({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:n});return e.createElement(c.Flex,null,e.createElement(jt,{alignItems:"center",paddingLeft:6},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},i)),o.map(l=>l.isActionRelatedToCurrentProperty?e.createElement(Nt,{justifyContent:"center",key:l.label},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},a({id:`Settings.roles.form.permissions.${l.label.toLowerCase()}`,defaultMessage:l.label}))):e.createElement(Nt,{key:l.label})))};Ut.propTypes={headers:s().arrayOf(s().shape({label:s().string.isRequired,isActionRelatedToCurrentProperty:s().bool.isRequired})).isRequired,label:s().string.isRequired};const $t=Ut;var et=t(42982);const Mt=y.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,Lt=()=>e.createElement(Mt,null,"*"),Wt=(o,n)=>o.map(a=>{const i=Array.isArray(a.subjects)&&a.subjects.indexOf(n)!==-1;return{...a,isDisplayed:i}});var zt=t(87462);const Zt=(0,y.default)(c.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,Gt=y.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:n})=>o.colors[n]};
  }
`,ut=o=>e.createElement(Zt,null,e.createElement(Gt,{width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));ut.defaultProps={fill:"primary200"},ut.propTypes={fill:s().string};const Vt=(0,e.memo)(ut);var Dt=function(){return window&&window.strapi&&window.strapi.isEE?t(76766).Z:t(53558).Z}(),mt=(0,y.default)(c.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],ie),Ht=(0,y.default)(c.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],$e),xt=(0,y.default)(c.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),Kt=(0,y.default)(c.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var n=o.isVisible,a=o.theme;return n?"4px solid ".concat(a.colors.primary200):"4px solid transparent"}),C=(0,y.default)(c.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var n=o.theme;return n.spaces[4]},function(o){var n=o.level;return 145-n*36},function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ke,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(_e(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&_e(a)}),m=y.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var n=o.theme;return n.spaces[2]},function(o){var n=o.theme;return n.spaces[2]},4/16,function(o){var n=o.theme;return n.colors.primary200}),g=function o(n){var a=n.childrenForm,i=n.isFormDisabled,l=n.recursiveLevel,d=n.pathToDataFromActionRow,p=n.propertyActions,h=n.parentName,b=n.propertyName,T=(0,X.useIntl)(),M=T.formatMessage,L=(0,ae.$_)(),I=L.modifiedData,W=L.onChangeParentCheckbox,F=L.onChangeSimpleCheckbox,z=(0,e.useState)(null),P=(0,Ae.Z)(z,2),B=P[0],Q=P[1],de=function(he){Q(function(Me){return Me===he?null:he})},Ne=(0,e.useMemo)(function(){return B?a.find(function(Se){var he=Se.value;return he===B}):null},[B,a]);return e.createElement(xt,null,e.createElement(m,null),a.map(function(Se,he){var Me=Se.label,Te=Se.value,nt=Se.required,ue=Se.children,Le=he+1<a.length,ne=Array.isArray(ue),pe=B===Te;return e.createElement(Kt,{key:Te,isVisible:Le},e.createElement(Ht,null,e.createElement(Vt,{color:"primary200"}),e.createElement(c.Flex,{style:{flex:1}},e.createElement(C,{level:l,isActive:pe,isCollapsable:ne},e.createElement(ct,(0,zt.Z)({alignItems:"center",isCollapsable:ne},ne&&{onClick:function(){return de(Te)},"aria-expanded":pe,onKeyDown:function(De){var Ie=De.key;return(Ie==="Enter"||Ie===" ")&&de(Te)},tabIndex:0,role:"button"},{title:Me}),e.createElement(c.Typography,{ellipsis:!0},_()(Me)),nt&&e.createElement(Lt,null),e.createElement(Ke,{$isActive:pe}))),e.createElement(c.Flex,{style:{flex:1}},p.map(function(fe){var De=fe.actionId,Ie=fe.label,qe=fe.isActionRelatedToCurrentProperty;if(!qe)return e.createElement(J,{key:De});var we=[].concat((0,et.Z)(d.split("..")),[De,"properties",b],(0,et.Z)(h.split("..")),[Te]),Xe=G()(I,we,!1);if(!ue)return e.createElement(mt,{key:Ie,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:i||Dt,name:we.join(".."),"aria-label":M({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(Me," ").concat(Ie)}),onValueChange:function(Ct){F({target:{name:we.join(".."),value:Ct}})},value:Xe}));var it=He(Xe),rt=it.hasAllActionsSelected,ot=it.hasSomeActionsSelected;return e.createElement(mt,{key:Ie,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{key:Ie,disabled:i||Dt,name:we.join(".."),"aria-label":M({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(Me," ").concat(Ie)}),onValueChange:function(Ct){W({target:{name:we.join(".."),value:Ct}})},value:rt,indeterminate:ot}))})))),Ne&&pe&&e.createElement(c.Box,{paddingBottom:2},e.createElement(o,{isFormDisabled:i,parentName:"".concat(h,"..").concat(Te),pathToDataFromActionRow:d,propertyActions:p,propertyName:b,recursiveLevel:l+1,childrenForm:Ne.children})))}))};g.propTypes={childrenForm:s().array.isRequired,isFormDisabled:s().bool.isRequired,parentName:s().string.isRequired,pathToDataFromActionRow:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,recursiveLevel:s().number.isRequired};const A=(0,e.memo)(g),u=o=>o.reduce((a,i)=>(i.isActionRelatedToCurrentProperty&&a.push(i.actionId),a),[]),N=(o,n,a,i,l)=>{const p=u(o).reduce((h,b)=>{const T=[...a.split(".."),b,"properties",i,l],M=(0,v.get)(n,T,!1);return h[b]=M,h},{});return He(p)};var H=function(){return window&&window.strapi&&window.strapi.isEE?t(74512).Z:t(35820).Z}(),k=(0,y.default)(c.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],ie),w=(0,y.default)(c.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],$e,function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ke,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(_e(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&_e(a)}),be=function(n){var a=n.childrenForm,i=n.label,l=n.isFormDisabled,d=n.name,p=n.required,h=n.pathToData,b=n.propertyActions,T=n.propertyName,M=n.isOdd,L=(0,X.useIntl)(),I=L.formatMessage,W=(0,e.useState)(null),F=(0,Ae.Z)(W,2),z=F[0],P=F[1],B=(0,ae.$_)(),Q=B.modifiedData,de=B.onChangeCollectionTypeLeftActionRowCheckbox,Ne=B.onChangeParentCheckbox,Se=B.onChangeSimpleCheckbox,he=z===d,Me=(0,e.useMemo)(function(){return Array.isArray(a)?a:[]},[a]),Te=Me.length>0,nt=(0,e.useCallback)(function(){Te&&P(function(fe){return fe===d?null:d})},[Te,d]),ue=function(De){var Ie=De.target.value;de(h,T,d,Ie)},Le=(0,e.useMemo)(function(){return N(b,Q,h,T,d)},[b,Q,h,T,d]),ne=Le.hasAllActionsSelected,pe=Le.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(w,{alignItems:"center",isCollapsable:Te,isActive:he,background:M?"neutral100":"neutral0"},e.createElement(c.Flex,null,e.createElement(yt,{onChange:ue,onClick:nt,isCollapsable:Te,isFormDisabled:l,label:i,someChecked:pe,value:ne,isActive:he},p&&e.createElement(Lt,null),e.createElement(Ke,{$isActive:he})),e.createElement(c.Flex,null,b.map(function(fe){var De=fe.label,Ie=fe.isActionRelatedToCurrentProperty,qe=fe.actionId;if(!Ie)return e.createElement(J,{key:De});var we=[].concat((0,et.Z)(h.split("..")),[qe,"properties",T,d]);if(!Te){var Xe=G()(Q,we,!1);return e.createElement(k,{key:qe,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:l||H,name:we.join(".."),"aria-label":I({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(De)}),onValueChange:function(an){Se({target:{name:we.join(".."),value:an}})},value:Xe}))}var it=G()(Q,we,{}),rt=He(it),ot=rt.hasAllActionsSelected,on=rt.hasSomeActionsSelected;return e.createElement(k,{key:De,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:l||H,name:we.join(".."),onValueChange:function(an){Ne({target:{name:we.join(".."),value:an}})},"aria-label":I({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(De)}),value:ot,indeterminate:on}))})))),he&&e.createElement(A,{childrenForm:Me,isFormDisabled:l,parentName:d,pathToDataFromActionRow:h,propertyName:T,propertyActions:b,recursiveLevel:0}))};be.defaultProps={childrenForm:[],required:!1},be.propTypes={childrenForm:s().array,label:s().string.isRequired,isFormDisabled:s().bool.isRequired,name:s().string.isRequired,pathToData:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,required:s().bool,isOdd:s().bool.isRequired};const oe=(0,e.memo)(be),ke=y.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Pe=({availableActions:o,childrenForm:n,isFormDisabled:a,label:i,pathToData:l,propertyName:d})=>{const p=(0,e.useMemo)(()=>wt(o,d),[o,d]);return e.createElement(ke,null,e.createElement($t,{label:i,headers:p}),e.createElement(c.Box,null,n.map(({children:h,label:b,value:T,required:M},L)=>e.createElement(oe,{childrenForm:h,key:T,label:b,isFormDisabled:a,name:T,required:M,propertyActions:p,pathToData:l,propertyName:d,isOdd:L%2===0}))))};Pe.propTypes={childrenForm:s().array.isRequired,availableActions:s().array.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,pathToData:s().string.isRequired,propertyName:s().string.isRequired};const We=Pe,Ze=y.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:n})=>n&&`border: 1px solid ${o.colors.primary600};`}
`,ze=({allActions:o,contentTypeName:n,label:a,index:i,isActive:l,isFormDisabled:d,onClickToggleCollapse:p,pathToData:h,properties:b})=>{const T=(0,e.useCallback)(()=>{p(n)},[n,p]),M=(0,e.useMemo)(()=>Wt(o,n),[o,n]);return e.createElement(Ze,{isActive:l},e.createElement(kt,{availableActions:M,isActive:l,isGrey:i%2===0,isFormDisabled:d,label:a,onClickToggle:T,pathToData:h}),l&&b.map(({label:L,value:I,children:W})=>e.createElement(We,{availableActions:M,childrenForm:W,isFormDisabled:d,label:L,pathToData:h,propertyName:I,key:I})))};ze.propTypes={allActions:s().array.isRequired,contentTypeName:s().string.isRequired,index:s().number.isRequired,isActive:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggleCollapse:s().func.isRequired,pathToData:s().string.isRequired,properties:s().array.isRequired};const pt=ze,gt=({actions:o,isFormDisabled:n,pathToData:a,subjects:i})=>{const[l,d]=(0,e.useState)(null),p=h=>{d(l===h?null:h)};return i.map(({uid:h,label:b,properties:T},M)=>e.createElement(pt,{allActions:o,key:h,contentTypeName:h,label:b,isActive:l===h,isFormDisabled:n,index:M,onClickToggleCollapse:p,pathToData:`${a}..${h}`,properties:T}))};gt.defaultProps={actions:[],subjects:[]},gt.propTypes={actions:s().array.isRequired,isFormDisabled:s().bool.isRequired,pathToData:s().string.isRequired,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))};const Xt=(0,e.memo)(gt),Yt=o=>o.filter(({subjects:n})=>n&&n.length),Jt=o=>o.map(({actionId:n})=>n),ht=(o,n)=>o.reduce((a,i)=>(Object.keys(n).forEach(l=>{const d=(0,v.get)(n,[l,i],{}),p={[l]:bt(d)};a[i]?a[i]={...a[i],...p}:a[i]=p}),a),{}),tt=(o,n)=>{const a=Jt(o),i=ht(a,n);return Object.keys(i).reduce((d,p)=>(d[p]=He(i[p]),d),{})};var Qe=function(){return window&&window.strapi&&window.strapi.isEE?t(85822).Z:t(99047).Z}(),Ye=(0,y.default)(c.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],ie),st=function(n){var a=n.actions,i=n.isFormDisabled,l=n.kind,d=(0,X.useIntl)(),p=d.formatMessage,h=(0,ae.$_)(),b=h.modifiedData,T=h.onChangeCollectionTypeGlobalActionCheckbox,M=(0,e.useMemo)(function(){return Yt(a)},[a]),L=(0,e.useMemo)(function(){return tt(M,b[l])},[b,M,l]);return e.createElement(c.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Ue}},e.createElement(c.Stack,{horizontal:!0,spacing:0},M.map(function(I){var W=I.label,F=I.actionId;return e.createElement(Ye,{key:F,spacing:3},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},p({id:"Settings.roles.form.permissions.".concat(W.toLowerCase()),defaultMessage:W})),e.createElement(c.BaseCheckbox,{disabled:i||Qe,onValueChange:function(P){T(l,F,P)},name:F,"aria-label":p({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:p({id:"Settings.roles.form.permissions.".concat(W.toLowerCase()),defaultMessage:W})}),value:G()(L,[F,"hasAllActionsSelected"],!1),indeterminate:G()(L,[F,"hasSomeActionsSelected"],!1)}))})))};st.defaultProps={actions:[]},st.propTypes={actions:s().arrayOf(s().shape({label:s().string.isRequired,actionId:s().string.isRequired,subjects:s().array.isRequired})),isFormDisabled:s().bool.isRequired,kind:s().string.isRequired};const Je=(0,e.memo)(st),On=(0,y.default)(c.Box)`
  overflow-x: auto;
`,gn=({isFormDisabled:o,kind:n,layout:{actions:a,subjects:i}})=>{const l=re()([...i],"label");return e.createElement(On,{background:"neutral0"},e.createElement(Je,{actions:a,kind:n,isFormDisabled:o}),e.createElement(Xt,{actions:a,isFormDisabled:o,pathToData:n,subjects:l}))};gn.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().shape({actions:s().array,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))}).isRequired};const hn=(0,e.memo)(gn);var Fn=t(47713);const fn=({children:o,value:n})=>e.createElement(Fn.$l.Provider,{value:n},o);fn.propTypes={children:s().node.isRequired,value:s().exact({availableConditions:s().array.isRequired,modifiedData:s().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:s().func.isRequired,onChangeConditions:s().func.isRequired,onChangeSimpleCheckbox:s().func.isRequired,onChangeParentCheckbox:s().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:s().func.isRequired}).isRequired};const Bn=fn,kn=(o,n,a)=>o.map(i=>{const l=[...a,i.action,"properties","enabled"],d=(0,v.get)(n,l,!1),p=(0,v.get)(n,[...a,i.action,"conditions"],{}),h=Ve(p).some(b=>b);return{...i,isDisplayed:d,checkboxName:l.join(".."),hasSomeActionsSelected:d,value:d,hasConditions:h,label:i.displayName,actionId:i.action,pathToConditionsObject:[...a,i.action]}}),wn=o=>{const n=Object.entries(o).reduce((i,l)=>{const[d,{conditions:p}]=l;return i[d]=p,i},{});return Ve(n).some(i=>i)};var qt=function(){return window&&window.strapi&&window.strapi.isEE?t(8629).Z:t(34341).Z}(),Nn=y.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var n=o.theme;return n.colors.neutral150}),jn=y.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var n=o.hasConditions,a=o.disabled,i=o.theme;return n&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(a?i.colors.neutral100:i.colors.primary600,`;
    }
  `)}),Cn=function(n){var a=n.categoryName,i=n.isFormDisabled,l=n.subCategoryName,d=n.actions,p=n.pathToData,h=(0,e.useState)(!1),b=(0,Ae.Z)(h,2),T=b[0],M=b[1],L=(0,ae.$_)(),I=L.modifiedData,W=L.onChangeParentCheckbox,F=L.onChangeSimpleCheckbox,z=(0,X.useIntl)(),P=z.formatMessage,B=G()(I,p,{}),Q=(0,e.useMemo)(function(){return Object.keys(B).reduce(function(ue,Le){return ue[Le]=bt(B[Le]),ue},{})},[B]),de=He(Q),Ne=de.hasAllActionsSelected,Se=de.hasSomeActionsSelected,he=function(){M(function(Le){return!Le})},Me=function(){M(!1)},Te=kn(d,I,p),nt=wn(G()(I,(0,et.Z)(p),{}));return e.createElement(e.Fragment,null,e.createElement(c.Box,null,e.createElement(c.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(c.Box,{paddingRight:4},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},l)),e.createElement(Nn,null),e.createElement(c.Box,{paddingLeft:4},e.createElement(c.Checkbox,{name:p.join(".."),disabled:i||qt,onValueChange:function(Le){W({target:{name:p.join(".."),value:Le}})},indeterminate:Se,value:Ne},P({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(c.Flex,{paddingTop:6,paddingBottom:6},e.createElement(c.Grid,{gap:2,style:{flex:1}},Te.map(function(ue){var Le=ue.checkboxName,ne=ue.value,pe=ue.action,fe=ue.displayName,De=ue.hasConditions;return e.createElement(c.GridItem,{col:3,key:pe},e.createElement(jn,{disabled:i||qt,hasConditions:De},e.createElement(c.Checkbox,{name:Le,disabled:i||qt,onValueChange:function(qe){F({target:{name:Le,value:qe}})},value:ne},fe)))})),e.createElement(x,{hasConditions:nt,onClick:he}))),T&&e.createElement(V,{headerBreadCrumbs:[a,l],actions:Te,isFormDisabled:i,onClosed:Me,onToggle:he}))};Cn.propTypes={actions:s().array.isRequired,categoryName:s().string.isRequired,isFormDisabled:s().bool.isRequired,subCategoryName:s().string.isRequired,pathToData:s().array.isRequired};const Un=Cn,_t=({childrenForm:o,kind:n,name:a,isOpen:i,isFormDisabled:l,isWhite:d,onOpenCategory:p,pathToData:h})=>{const{formatMessage:b}=(0,X.useIntl)(),T=()=>{p(a)},M=(0,e.useMemo)(()=>a.split("::").pop(),[a]);return e.createElement(c.Accordion,{expanded:i,onToggle:T,id:`accordion-${a}`,variant:d?"primary":"secondary"},e.createElement(c.AccordionToggle,{title:_()(M),description:`${b({id:"Settings.permissions.category"},{category:M})} ${n==="plugins"?"plugin":n}`}),e.createElement(c.AccordionContent,null,e.createElement(c.Box,{padding:6},o.map(({actions:L,subCategoryName:I,subCategoryId:W})=>e.createElement(Un,{key:I,actions:L,categoryName:M,isFormDisabled:l,subCategoryName:I,pathToData:[...h,W]})))))};_t.defaultProps={},_t.propTypes={childrenForm:s().array.isRequired,isOpen:s().bool.isRequired,isFormDisabled:s().bool.isRequired,isWhite:s().bool.isRequired,kind:s().string.isRequired,name:s().string.isRequired,onOpenCategory:s().func.isRequired,pathToData:s().array.isRequired};const $n=_t,En=({isFormDisabled:o,kind:n,layout:a})=>{const[i,l]=(0,e.useState)(null),d=p=>{l(p===i?null:p)};return e.createElement(c.Box,{padding:6,background:"neutral0"},a.map(({category:p,categoryId:h,childrenForm:b},T)=>e.createElement($n,{key:p,childrenForm:b,kind:n,isFormDisabled:o,isOpen:i===p,isWhite:T%2===1,name:p,onOpenCategory:d,pathToData:[n,h]})))};En.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().arrayOf(s().shape({category:s().string.isRequired,categoryId:s().string.isRequired,childrenForm:s().arrayOf(s().shape({actions:s().array.isRequired})).isRequired}).isRequired).isRequired};const yn=En,vn=(o,n,a)=>o.find(i=>i.action===n&&i.subject===a),bn=(o,n=[])=>o.reduce((a,i)=>(a[i.id]=n.indexOf(i.id)!==-1,a),{}),Sn=({children:o},n,a="")=>o.reduce((i,l)=>{if(l.children)return{...i,[l.value]:Sn(l,n,`${a}${l.value}.`)};const d=n.indexOf(`${a}${l.value}`)!==-1;return i[l.value]=d,i},{}),Wn=(o,n,a)=>o.reduce((i,l)=>{const d=n.properties.find(({value:p})=>p===l);if(d){const p=(0,v.get)(a,["properties",d.value],[]),h=Sn(d,p);i.properties[l]=h}return i},{properties:{}}),zn=(o,n)=>n.reduce((a,i)=>{const l=o.find(({uid:d})=>d===i)||null;return l&&(a[i]=l),a},{}),Tn=({subjects:o},n,a,i=[])=>n.reduce((l,d)=>{const p=d.subjects,h=zn(o,p);if((0,v.isEmpty)(h))return l;const b=Object.keys(h).reduce((T,M)=>{const{actionId:L,applyToProperties:I}=d,z=h[M].properties.map(({value:de})=>de).every(de=>(I||[]).indexOf(de)===-1),P=vn(i,L,M),B=bn(a,(0,v.get)(P,"conditions",[]));if((0,v.isEmpty)(I)||z)return(0,v.set)(T,[M,L],{properties:{enabled:P!==void 0},conditions:B}),T;const Q=Wn(I,h[M],P);return(0,v.set)(T,[M,L],{...Q,conditions:B}),T},{});return(0,v.merge)(l,b)},{}),Zn=(o,n,a)=>o.reduce((i,l)=>{const d=vn(a,l.action,null);return i[l.action]={properties:{enabled:d!==void 0},conditions:bn(n,(0,v.get)(d,"conditions",[]))},i},{}),Gn=(o,n,a)=>o.reduce((i,l)=>(i[l.subCategoryId]=Zn(l.actions,n,a),i),{}),An=(o,n,a=[])=>o.reduce((i,{categoryId:l,childrenForm:d})=>{const p=Gn(d,n,a);return i[l]=p,i},{}),Rn=o=>o.split(" ").join("-"),Mn=(o,n)=>Object.entries(j()(o,n)).map(([a,i])=>({category:a,categoryId:Rn(a),childrenForm:Object.entries(j()(i,"subCategory")).map(([l,d])=>({subCategoryName:l,subCategoryId:Rn(l),actions:d}))})),Vn=(o,n)=>{const{conditions:a,sections:{collectionTypes:i,singleTypes:l,plugins:d,settings:p}}=o,h={collectionTypes:i,singleTypes:l,plugins:Mn(d,"plugin"),settings:Mn(p,"category")},b={collectionTypes:Tn(i,i.actions||[],a,n),singleTypes:Tn(l,l.actions||[],a,n),plugins:An(h.plugins,a,n),settings:An(h.settings,a,n)};return{initialData:b,modifiedData:b,layouts:h}},Ln=o=>Object.keys(o).reduce((n,a)=>{const i=o[a];if((0,v.isObject)(i)&&!(0,v.has)(i,"conditions"))return{...n,[a]:Ln(i)};if((0,v.isObject)(i)&&(0,v.has)(i,"conditions")&&!Ve((0,v.omit)(i,"conditions")).some(d=>d)){const d=Object.keys(i.conditions).reduce((p,h)=>(p[h]=!1,p),{});return{...n,[a]:{...i,conditions:d}}}return n[a]=i,n},{}),en=Ln,Dn=(o,n)=>Object.keys(o).reduce((a,i)=>{const l=o[i];return i==="conditions"?(a[i]=l,a):(0,v.isObject)(l)?{...a,[i]:Dn(l,n)}:(a[i]=n,a)},{}),Pt=Dn,Hn={initialData:{},modifiedData:{},layouts:{}},Kn=(o,n)=>(0,ce.default)(o,a=>{switch(n.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:i,actionId:l,value:d}=n,p=["modifiedData",i];Object.keys((0,v.get)(o,p)).forEach(h=>{const b=(0,v.get)(o,[...p,h,l],void 0);if(b){let T=Pt(b,d);if(!d&&T.conditions){const M=Pt(T.conditions,!1);T={...T,conditions:M}}(0,v.set)(a,[...p,h,l],T)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:i,propertyName:l,rowName:d,value:p}=n;let h=(0,v.cloneDeep)(o.modifiedData);const b=i.split(".."),T=(0,v.get)(h,b,{});Object.keys(T).forEach(M=>{if((0,v.has)(T[M],`properties.${l}`)){const L=(0,v.get)(T,[M,"properties",l,d]),I=[...b,M,"properties",l,d];if(!(0,v.isObject)(L))(0,v.set)(h,I,p);else{const W=Pt(L,p);(0,v.set)(h,I,W)}}}),p||(h=en(h)),(0,v.set)(a,"modifiedData",h);break}case"ON_CHANGE_CONDITIONS":{Object.entries(n.conditions).forEach(i=>{const[l,d]=i;(0,v.set)(a,["modifiedData",...l.split(".."),"conditions"],d)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let i=(0,v.cloneDeep)(o.modifiedData);(0,v.set)(i,[...n.keys.split("..")],n.value),n.value||(i=en(i)),(0,v.set)(a,"modifiedData",i);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:i,value:l}=n,d=[...i.split("..")];let p=(0,v.cloneDeep)(o.modifiedData);const h=(0,v.get)(p,d,{}),b=Pt(h,l);(0,v.set)(p,d,b),l||(p=en(p)),(0,v.set)(a,["modifiedData"],p);break}case"RESET_FORM":{a.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{a.initialData=o.modifiedData;break}default:return a}}),tn=o=>Object.entries(o).filter(([,n])=>n).map(([n])=>n),Xn=o=>{const[n,{conditions:a}]=o;return{action:n,subject:null,conditions:tn(a),properties:{}}},Qn=o=>Object.values(o).reduce((n,a)=>{const i=Object.entries(a).reduce((l,d)=>{const[,{properties:{enabled:p}}]=d;if(!p)return l;const h=Xn(d);return l.push(h),l},[]);return[...n,...i]},[]),xn=o=>Object.values(o).reduce((n,a)=>{const i=Qn(a);return[...n,...i]},[]),Pn=(o,n="")=>Object.entries(o).reduce((a,i)=>{const[l,d]=i;return(0,v.isObject)(d)?[...a,...Pn(d,`${n}${l}.`)]:(d&&!(0,v.isObject)(d)&&a.push(`${n}${l}`),a)},[]),Yn=(o,n,{conditions:a,properties:i})=>Object.entries(i).reduce((l,d)=>{const[p,h]=d;return l.properties[p]=Pn(h),l},{action:o,subject:n,conditions:tn(a),properties:{}}),Jn=(o,n,{conditions:a})=>({action:o,subject:n,properties:{},conditions:tn(a)}),qn=(o,n)=>Object.entries(n).reduce((i,l)=>{const[d,p]=l;if(!Ve(p).some(T=>T))return i;if(!(0,v.has)(p,"properties.enabled")){const T=Yn(d,o,p);return[...i,T]}if(!p.properties.enabled)return i;const b=Jn(d,o,p);return i.push(b),i},[]),In=o=>Object.entries(o).reduce((a,i)=>{const[l,d]=i,p=qn(l,d);return[...a,...p]},[]),_n=o=>{const n=xn(o.plugins),a=xn(o.settings),i=In(o.collectionTypes),l=In(o.singleTypes);return[...n,...a,...i,...l]},eo=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}],nn=(0,e.forwardRef)(({layout:o,isFormDisabled:n,permissions:a},i)=>{const[{initialData:l,layouts:d,modifiedData:p},h]=(0,e.useReducer)(Kn,Hn,()=>Vn(o,a)),{formatMessage:b}=(0,X.useIntl)();(0,e.useImperativeHandle)(i,()=>({getPermissions(){const F=(0,r.difference)(l.collectionTypes,p.collectionTypes),z=(0,r.difference)(l.singleTypes,p.singleTypes),P={...F,...z};let B;return $()(P)?B=!1:B=Object.values(P).some(Q=>Object.values(Q).some(de=>K()(de,"conditions"))),{permissionsToSend:_n(p),didUpdateConditions:B}},resetForm(){h({type:"RESET_FORM"})},setFormAfterSubmit(){h({type:"SET_FORM_AFTER_SUBMIT"})}}));const T=(F,z,P,B)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:F,propertyName:z,rowName:P,value:B})},M=(F,z,P)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:F,actionId:z,value:P})},L=F=>{h({type:"ON_CHANGE_CONDITIONS",conditions:F})},I=(0,e.useCallback)(({target:{name:F,value:z}})=>{h({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:F,value:z})},[]),W=(0,e.useCallback)(({target:{name:F,value:z}})=>{h({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:F,value:z})},[]);return e.createElement(Bn,{value:{availableConditions:o.conditions,modifiedData:p,onChangeConditions:L,onChangeSimpleCheckbox:I,onChangeParentCheckbox:W,onChangeCollectionTypeLeftActionRowCheckbox:T,onChangeCollectionTypeGlobalActionCheckbox:M}},e.createElement(c.TabGroup,{id:"tabs",label:b({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(c.Tabs,null,eo.map(F=>e.createElement(c.Tab,{key:F.id},b({id:F.labelId,defaultMessage:F.defaultMessage})))),e.createElement(c.TabPanels,{style:{position:"relative"}},e.createElement(c.TabPanel,null,e.createElement(hn,{layout:d.collectionTypes,kind:"collectionTypes",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(hn,{layout:d.singleTypes,kind:"singleTypes",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(yn,{layout:d.plugins,kind:"plugins",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(yn,{layout:d.settings,kind:"settings",isFormDisabled:n})))))});nn.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},nn.propTypes={layout:s().object,isFormDisabled:s().bool.isRequired,permissions:s().array};const to=(0,e.memo)(nn)},34341:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},67500:(O,R,t)=>{"use strict";t.d(R,{Z:()=>e});const e=()=>"todo empty role"},52351:(O,R,t)=>{"use strict";t.d(R,{Z:()=>X});var e=t(67294),f=t(45697),s=t.n(f),r=t(28702),c=t.n(r),S=t(95489),K=t.n(S),Z=t(97132);const $=({id:y,name:Ce,description:re,usersCount:Ae,icons:le,rowIndex:E})=>{const{formatMessage:G}=(0,Z.useIntl)(),Ee=G({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:Ae});return e.createElement(r.Tr,{"aria-rowindex":E,key:y,...(0,S.onRowClick)({fn:le[1].onClick})},e.createElement(r.Td,{maxWidth:(0,S.pxToRem)(130)},e.createElement(r.Typography,{ellipsis:!0,textColor:"neutral800"},Ce)),e.createElement(r.Td,{maxWidth:(0,S.pxToRem)(250)},e.createElement(r.Typography,{ellipsis:!0,textColor:"neutral800"},re)),e.createElement(r.Td,null,e.createElement(r.Typography,{textColor:"neutral800"},Ee)),e.createElement(r.Td,null,e.createElement(r.Flex,{justifyContent:"flex-end",...S.stopPropagation},le.map((me,ae)=>me?e.createElement(r.Box,{key:me.label,paddingLeft:ae===0?0:1},e.createElement(r.IconButton,{onClick:me.onClick,label:me.label,noBorder:!0,icon:me.icon})):null))))};$.propTypes={id:s().number.isRequired,name:s().string.isRequired,description:s().string.isRequired,usersCount:s().number.isRequired,icons:s().array.isRequired,rowIndex:s().number.isRequired};const X=$},85302:(O,R,t)=>{"use strict";t.d(R,{Z:()=>Oe});var e=t(67294),f=t(95489),s=t(87751),r=t(63852),c=t(41363),S=t(28702),K=t(97132),Z=t(49656),$=t(52351),X=t(67500),y=t(45697),Ce=t.n(y),re=t(27821),Ae=t(80994);const le=t.p+"6d21938306785f176538.png",E=t.p+"617f9c948fa79e6d73bd.png",G=re.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:D})=>(0,f.setHexOpacity)(D.colors.neutral800,.2)};
  padding: 0 ${({theme:D})=>D.spaces[8]};
`,Ee=(0,re.default)(S.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,me=(0,re.default)(S.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,ae=(0,re.default)(S.Box)`
  position: absolute;
  right: ${({theme:D})=>D.spaces[4]};
  top: ${({theme:D})=>D.spaces[4]};
`,je=({onClose:D,isOpen:U})=>{(0,f.useLockScroll)(U);const{formatMessage:q}=(0,K.useIntl)();return U?e.createElement(S.Portal,null,e.createElement(G,{onClick:D},e.createElement(S.FocusTrap,{onEscape:D},e.createElement(Ee,{onClick:ee=>ee.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:le,alt:"air-balloon"}),e.createElement(ae,null,e.createElement(S.IconButton,{onClick:D,"aria-label":"Close",icon:e.createElement(c.Cross,null)})),e.createElement(me,{spacing:6},e.createElement(S.Typography,{fontWeight:"bold",textColor:"primary600"},q({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(S.Stack,{spacing:2},e.createElement(S.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},q({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(S.Typography,null,q({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(Ae.Q,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(c.ExternalLink,null)},q({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:E,alt:"upgrade-arrow"}))))):null};je.propTypes={onClose:Ce().func.isRequired,isOpen:Ce().bool.isRequired};const Ge=je;var x=t(48474);const ce=()=>{const{roles:D,isLoading:U}=(0,x.bF)(),q=(0,f.useQuery)(),ee=decodeURIComponent(q.get("_q")||""),ye=(0,r.ZP)(D,ee,{keys:["name","description"]});return{isLoading:U,sortedRoles:ye}},Y=()=>{const{formatMessage:D}=(0,K.useIntl)(),[U,q]=(0,e.useState)(!1),{trackUsage:ee}=(0,f.useTracking)(),{push:ye}=(0,Z.useHistory)(),v=(0,e.useCallback)(se=>{ye(`/settings/roles/${se}`)},[ye]),ge=(0,e.useCallback)(()=>{q(se=>!se)},[]),Fe=(0,e.useCallback)(()=>{ee("didShowRBACUpgradeModal"),q(!0)},[ee]),Be=(0,e.useCallback)(se=>[{onClick:ge,label:D({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(c.Duplicate,null)},{onClick:()=>v(se.id),label:D({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(c.Pencil,null)},{onClick:ge,label:D({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(c.Trash,null)}],[D,ge,v]);return{isModalOpen:U,handleToggleModalForCreatingRole:Fe,handleToggle:ge,getIcons:Be}},xe=()=>{const{formatMessage:D}=(0,K.useIntl)();(0,f.useFocusWhenNavigate)();const{sortedRoles:U,isLoading:q}=ce(),{isModalOpen:ee,handleToggle:ye,handleToggleModalForCreatingRole:v,getIcons:ge}=Y(),Fe=U.length+1,Be=5;return e.createElement(S.Main,null,e.createElement(f.SettingsPageTitle,{name:"Roles"}),e.createElement(S.HeaderLayout,{primaryAction:e.createElement(S.Button,{onClick:v,startIcon:e.createElement(c.Plus,null),size:"S"},D({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:D({id:"global.roles",defaultMessage:"roles"}),subtitle:D({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(S.ContentLayout,null,e.createElement(S.Table,{colCount:Be,rowCount:Fe,footer:e.createElement(S.TFooter,{onClick:v,icon:e.createElement(c.Plus,null)},D({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(S.Thead,null,e.createElement(S.Tr,null,e.createElement(S.Th,null,e.createElement(S.Typography,{variant:"sigma",textColor:"neutral600"},D({id:"global.name",defaultMessage:"Name"}))),e.createElement(S.Th,null,e.createElement(S.Typography,{variant:"sigma",textColor:"neutral600"},D({id:"global.description",defaultMessage:"Description"}))),e.createElement(S.Th,null,e.createElement(S.Typography,{variant:"sigma",textColor:"neutral600"},D({id:"global.users",defaultMessage:"Users"}))),e.createElement(S.Th,null,e.createElement(S.VisuallyHidden,null,D({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(S.Tbody,null,U?.map((se,Re)=>e.createElement($.Z,{key:se.id,id:se.id,name:se.name,description:se.description,usersCount:se.usersCount,icons:ge(se),rowIndex:Re+2})))),!Fe&&!q&&e.createElement(X.Z,null)),e.createElement(Ge,{isOpen:ee,onClose:ye}))},Oe=()=>e.createElement(f.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(xe,null))},35301:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=[]},78413:(O,R,t)=>{"use strict";t.d(R,{Z:()=>Ae});var e=t(67294),f=t(97132),s=t(28702),r=t.n(s),c=t(36182),S=t(41363),K=t.n(S),Z=t(95489),$=t.n(Z),X=t(90594);const y="https://cloud.strapi.io/profile/billing",Ce="https://strapi.io/billing/request-seats",Ae=()=>{const{formatMessage:le}=(0,f.useIntl)(),{license:E}=(0,X.q5)(),{licenseLimitStatus:G,enforcementUserCount:Ee,permittedSeats:me,isHostedOnStrapiCloud:ae}=E?.data??{};return me?e.createElement(s.GridItem,{col:6,s:12},e.createElement(s.Typography,{variant:"sigma",textColor:"neutral600"},le({id:"Settings.application.admin-seats",defaultMessage:"Admin seats"})),e.createElement(s.Stack,{spacing:2,horizontal:!0},e.createElement(s.Flex,null,e.createElement(s.Typography,{as:"p"},le({id:"Settings.application.ee.admin-seats.count",defaultMessage:"<text>{enforcementUserCount}</text>/{permittedSeats}"},{permittedSeats:me,enforcementUserCount:Ee,text:je=>e.createElement(s.Typography,{fontWeight:"semiBold",textColor:Ee>me?"danger500":null},je)}))),G==="OVER_LIMIT"&&e.createElement(s.Tooltip,{description:le({id:"Settings.application.ee.admin-seats.at-limit-tooltip",defaultMessage:"At limit: add seats to invite more users"})},e.createElement(s.Icon,{width:`${(0,Z.pxToRem)(14)}rem`,height:`${(0,Z.pxToRem)(14)}rem`,color:"danger500",as:S.ExclamationMarkCircle}))),e.createElement(c.r,{href:ae?y:Ce,isExternal:!0,endIcon:e.createElement(S.ExternalLink,null)},le({id:"Settings.application.ee.admin-seats.add-seats",defaultMessage:"{isHostedOnStrapiCloud, select, true {Add seats} other {Contact sales}}"},{isHostedOnStrapiCloud:ae}))):null}},26789:(O,R,t)=>{"use strict";t.d(R,{Z:()=>Ge});var e=t(67294),f=t(47292),s=t(95489),r=t(28702),c=t(41363),S=t(80831),K=t(27361),Z=t.n(K),$=t(41609),X=t.n($),y=t(97132),Ce=t(49656),re=t(27821),Ae=t(28834),le=t(48474),E=t(87751),G=t(53209);const me=G.Ry().shape({name:G.Z_().required(s.translatedErrors.required),description:G.Z_().required(s.translatedErrors.required)}),ae=re.default.div`
  border: 1px solid ${({theme:x})=>x.colors.primary200};
  background: ${({theme:x})=>x.colors.primary100};
  padding: ${({theme:x})=>`${x.spaces[2]} ${x.spaces[4]}`};
  color: ${({theme:x})=>x.colors.primary600};
  border-radius: ${({theme:x})=>x.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,je=()=>{const x=(0,s.useNotification)(),{lockApp:ce,unlockApp:Y}=(0,s.useOverlayBlocker)(),{formatMessage:j}=(0,y.useIntl)(),[xe,_]=(0,e.useState)(!1),{replace:Oe}=(0,Ce.useHistory)(),D=(0,e.useRef)(),{trackUsage:U}=(0,s.useTracking)(),q=(0,Ce.useRouteMatch)("/settings/roles/duplicate/:id"),ee=Z()(q,"params.id",null),{isLoading:ye,data:v}=(0,le.U_)(),{permissions:ge,isLoading:Fe}=(0,le.Dq)(ee),Be=Re=>{ce(),_(!0),U(ee?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,s.request)("/admin/roles",{method:"POST",body:Re})).then(async V=>{const{permissionsToSend:ie}=D.current.getPermissions();return U(ee?"didDuplicateRole":"didCreateNewRole"),V.data.id&&!X()(ie)&&await(0,s.request)(`/admin/roles/${V.data.id}/permissions`,{method:"PUT",body:{permissions:ie}}),V}).then(V=>{_(!1),x({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Oe(`/settings/roles/${V.data.id}`)}).catch(V=>{console.error(V),_(!1),x({type:"warning",message:{id:"notification.error"}})}).finally(()=>{Y()})},se=`${j({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,f.format)(new Date,"PPP")}`;return e.createElement(r.Main,null,e.createElement(s.SettingsPageTitle,{name:"Roles"}),e.createElement(S.Formik,{initialValues:{name:"",description:se},onSubmit:Be,validationSchema:me,validateOnChange:!1},({handleSubmit:Re,values:V,errors:ie,handleReset:Ue,handleChange:$e})=>e.createElement(s.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(r.HeaderLayout,{primaryAction:e.createElement(r.Stack,{horizontal:!0,spacing:2},e.createElement(r.Button,{variant:"secondary",onClick:()=>{Ue(),D.current.resetForm()},size:"L"},j({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(r.Button,{onClick:Re,loading:xe,size:"L"},j({id:"global.save",defaultMessage:"Save"}))),title:j({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:j({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(s.Link,{startIcon:e.createElement(c.ArrowLeft,null),to:"/settings/roles"},j({id:"global.back",defaultMessage:"Back"}))}),e.createElement(r.ContentLayout,null,e.createElement(r.Stack,{spacing:6},e.createElement(r.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(r.Stack,{spacing:4},e.createElement(r.Flex,{justifyContent:"space-between"},e.createElement(r.Box,null,e.createElement(r.Box,null,e.createElement(r.Typography,{fontWeight:"bold"},j({id:"global.details",defaultMessage:"Details"}))),e.createElement(r.Box,null,e.createElement(r.Typography,{variant:"pi",textColor:"neutral600"},j({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(ae,null,j({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(r.Grid,{gap:4},e.createElement(r.GridItem,{col:6},e.createElement(r.TextInput,{name:"name",error:ie.name&&j({id:ie.name}),label:j({id:"global.name",defaultMessage:"Name"}),onChange:$e,value:V.name})),e.createElement(r.GridItem,{col:6},e.createElement(r.Textarea,{label:j({id:"global.description",defaultMessage:"Description"}),name:"description",error:ie.description&&j({id:ie.description}),onChange:$e},V.description))))),!ye&&!Fe?e.createElement(r.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(Ae.Z,{isFormDisabled:!1,ref:D,permissions:ge,layout:v})):e.createElement(r.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(s.LoadingIndicatorPage,null))))))))};function Ge(){return e.createElement(s.CheckPagePermissions,{permissions:E.Z.settings.roles.create},e.createElement(je,null))}},53273:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},20591:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},74512:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},76766:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},85822:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},8629:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},64527:(O,R,t)=>{"use strict";t.d(R,{Z:()=>Ge});var e=t(67294),f=t(95489),s=t(87751),r=t(41363),c=t(28702),S=t(96486),K=t(63852),Z=t(97132),$=t(49656),X=t(48474),y=t(67500),Ce=t(52351),re=t(18172);const Ae={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},E=(x,ce)=>(0,re.default)(x,Y=>{switch(ce.type){case"ON_REMOVE_ROLES":{Y.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{Y.shouldRefetchData=!0,Y.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{Y.shouldRefetchData=!1,Y.roleToDelete=null,Y.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{Y.roleToDelete=ce.id;break}default:return Y}}),G=()=>{(0,f.useFocusWhenNavigate)();const{isLoading:x,allowedActions:{canCreate:ce,canDelete:Y,canRead:j,canUpdate:xe}}=(0,f.useRBAC)(s.Z.settings.roles),{getData:_,roles:Oe,isLoading:D}=(0,X.bF)(!1),[{query:U}]=(0,f.useQueryParams)(),q=U?._q||"",ee=(0,K.ZP)(Oe,q,{keys:["name","description"]});return(0,e.useEffect)(()=>{!x&&j&&_()},[x,j,_]),{isLoadingForPermissions:x,canCreate:ce,canDelete:Y,canRead:j,canUpdate:xe,isLoading:D,getData:_,sortedRoles:ee,roles:Oe}},Ee=({getData:x,canCreate:ce,canDelete:Y,canUpdate:j})=>{const{formatMessage:xe}=(0,Z.useIntl)(),_=(0,f.useNotification)(),[Oe,D]=(0,e.useState)(!1),{push:U}=(0,$.useHistory)(),[{selectedRoles:q,showModalConfirmButtonLoading:ee,roleToDelete:ye},v]=(0,e.useReducer)(E,Ae),{post:ge}=(0,f.getFetchClient)(),Fe=async()=>{try{v({type:"ON_REMOVE_ROLES"}),await ge("/admin/roles/batch-delete",{ids:[ye]}),await x(),v({type:"RESET_DATA_TO_DELETE"})}catch(J){const ve=(0,S.get)(J,["response","payload","data","ids"],null);if(ve&&Array.isArray(ve)){const ct=ve.join(`
`);_({type:"warning",message:ct})}else _({type:"warning",message:{id:"notification.error"}})}V()},Be=(0,e.useCallback)(J=>{U(`/settings/roles/duplicate/${J}`)},[U]),se=()=>U("/settings/roles/new"),Re=(0,e.useCallback)(J=>{v({type:"SET_ROLE_TO_DELETE",id:J}),V()},[]),V=()=>D(J=>!J),ie=(0,e.useCallback)(J=>{U(`/settings/roles/${J}`)},[U]),Ue=(0,e.useCallback)((J,ve)=>{J.preventDefault(),J.stopPropagation(),ve.usersCount?_({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):Re(ve.id)},[_,Re]),$e=(0,e.useCallback)((J,ve)=>{J.preventDefault(),J.stopPropagation(),Be(ve.id)},[Be]),lt=(0,e.useCallback)(J=>[...ce?[{onClick:ve=>$e(ve,J),label:xe({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(r.Duplicate,null)}]:[],...j?[{onClick:()=>ie(J.id),label:xe({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(r.Pencil,null)}]:[],...Y?[{onClick:ve=>Ue(ve,J),label:xe({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(r.Trash,null)}]:[]],[xe,Ue,$e,ie,ce,j,Y]);return{handleNewRoleClick:se,getIcons:lt,selectedRoles:q,isWarningDeleteAllOpened:Oe,showModalConfirmButtonLoading:ee,handleToggleModal:V,handleDeleteData:Fe}},ae=()=>{const{formatMessage:x}=(0,Z.useIntl)(),{isLoadingForPermissions:ce,canCreate:Y,canRead:j,canDelete:xe,canUpdate:_,isLoading:Oe,getData:D,sortedRoles:U}=G(),{handleNewRoleClick:q,getIcons:ee,isWarningDeleteAllOpened:ye,showModalConfirmButtonLoading:v,handleToggleModal:ge,handleDeleteData:Fe}=Ee({getData:D,canCreate:Y,canDelete:xe,canUpdate:_}),Be=U.length+1,se=6;if(ce)return e.createElement(c.Main,null,e.createElement(f.LoadingIndicatorPage,null));const Re=x({id:"global.roles",defaultMessage:"roles"});return e.createElement(c.Main,null,e.createElement(f.SettingsPageTitle,{name:"Roles"}),e.createElement(c.HeaderLayout,{primaryAction:Y?e.createElement(c.Button,{onClick:q,startIcon:e.createElement(r.Plus,null),size:"S"},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:Re,subtitle:x({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),j&&e.createElement(c.ActionLayout,{startActions:e.createElement(f.SearchURLQuery,{label:x({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:Re})})}),j&&e.createElement(c.ContentLayout,null,e.createElement(c.Table,{colCount:se,rowCount:Be,footer:Y?e.createElement(c.TFooter,{onClick:q,icon:e.createElement(r.Plus,null)},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(c.Thead,null,e.createElement(c.Tr,{"aria-rowindex":1},e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.name",defaultMessage:"Name"}))),e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.description",defaultMessage:"Description"}))),e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.users",defaultMessage:"Users"}))),e.createElement(c.Th,null,e.createElement(c.VisuallyHidden,null,x({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(c.Tbody,null,U?.map((V,ie)=>e.createElement(Ce.Z,{key:V.id,id:V.id,name:V.name,description:V.description,usersCount:V.usersCount,icons:ee(V),rowIndex:ie+2})))),!Be&&!Oe&&e.createElement(y.Z,null)),e.createElement(f.ConfirmDialog,{isOpen:ye,onConfirm:Fe,isConfirmButtonLoading:v,onToggleDialog:ge}))},Ge=()=>e.createElement(f.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(ae,null))},5420:(O,R,t)=>{"use strict";t.d(R,{Z:()=>f});const e=[];strapi.features.isEnabled(strapi.features.SSO)&&e.push({async Component(){return await t.e(302).then(t.bind(t,40316))},to:"/settings/single-sign-on",exact:!0}),strapi.features.isEnabled(strapi.features.AUDIT_LOGS)&&e.push({async Component(){return await t.e(2812).then(t.bind(t,35915))},to:"/settings/audit-logs",exact:!0});const f=e},44174:O=>{function R(t,e,f,s){for(var r=-1,c=t==null?0:t.length;++r<c;){var S=t[r];e(s,S,f(S),t)}return s}O.exports=R},81119:(O,R,t)=>{var e=t(89881);function f(s,r,c,S){return e(s,function(K,Z,$){r(S,K,c(K),$)}),S}O.exports=f},55189:(O,R,t)=>{var e=t(44174),f=t(81119),s=t(67206),r=t(1469);function c(S,K){return function(Z,$){var X=r(Z)?e:f,y=K?K():{};return X(Z,S,s($,2),y)}}O.exports=c},94654:(O,R,t)=>{var e=t(21078),f=t(35161);function s(r,c){return e(f(r,c),1)}O.exports=s},7739:(O,R,t)=>{var e=t(89465),f=t(55189),s=Object.prototype,r=s.hasOwnProperty,c=f(function(S,K,Z){r.call(S,Z)?S[Z].push(K):e(S,Z,[K])});O.exports=c},35161:(O,R,t)=>{var e=t(29932),f=t(67206),s=t(69199),r=t(1469);function c(S,K){var Z=r(S)?e:s;return Z(S,f(K,3))}O.exports=c}}]);
